[rules]
default_action = "approve"  # approve | deny | ask â€” by default everything is auto-approved

# Substrings stripped from commands before keyword matching, so they
# don't false-positive (e.g. "--rm" in "docker run --rm" won't trigger "rm ")
safe_substrings = ["--rm", "truncate -s", "git rm"]

# No deny keywords
[rules.deny]
keywords = []

# These commands will prompt the user for confirmation
[rules.ask]
keywords = [
    "rm ",
    "mv ",
    "rmdir",
    "unlink ",
    "rancher",
    "kubectl apply",
    "kubectl delete",
    "kubectl create",
    "kubectl patch",
    "kubectl replace",
    "kubectl edit",
    "kubectl scale",
    "kubectl autoscale",
    "kubectl rollout",
    "kubectl expose",
    "kubectl run",
    "kubectl set",
    "kubectl cordon",
    "kubectl uncordon",
    "kubectl drain",
    "kubectl taint",
    "kubectl label",
    "kubectl annotate",
    "kubectl exec",
    "kubectl cp",
    "kubectl debug",
    "kubectl config",
    "docker rm",
    "docker rmi",
    "docker system prune",
    "docker volume rm",
    "push --force",
    "push -f",
    "push.*main",
    "push.*master",
    "git reset --hard",
    "git clean",
    "git checkout .",
    "git restore .",
    "--no-verify",
    "drop ",
    "truncate ",
    "DELETE FROM",
    "killall ",
    "shutdown",
    "reboot",
    "brew uninstall",
    "brew remove",
    "pip uninstall",
    "npm uninstall",
]

# Scoped rules: auto-approve dangerous commands IF all file path arguments
# resolve within the project directory (git root of cwd). Falls through to
# normal ask behavior when paths can't be verified or escape the boundary.
[rules.scoped]
keywords = ["rm ", "mv ", "rmdir", "unlink "]
allow_project_dir = true   # auto-detect git root from cwd
allowed_dirs = []           # additional absolute paths, e.g. ["/tmp/scratch"]

# Allow keywords (not strictly needed since default is approve, but explicit)
[rules.allow]
keywords = []
